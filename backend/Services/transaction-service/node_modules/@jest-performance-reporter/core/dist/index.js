"use strict";var t=require("fs");const e=t=>{const e=[];return t.forEach((t=>{t.testResults.forEach((t=>e.push(t)))})),e},{createObjectCsvWriter:r}=require("csv-writer"),s=require("chalk"),i=console.log,a=s.bold.inverse,o=(t,e)=>{const{errorAfterMs:r,warnAfterMs:s}=e;return t>r?"error":t>s?"warn":"success"},n=new Intl.NumberFormat("en-US",{minimumFractionDigits:1,maximumFractionDigits:1}),l=t=>n.format(t/1e3)+" s",u=(t,e)=>{const{logLevel:r,maxItems:s=5}=e,n=[...t].sort(((t,e)=>e.duration-t.duration)).slice(0,s);if("error"===r||"warn"===r||"success"===r){n.filter((t=>"error"===o(t.duration,e))).forEach((t=>((t,...e)=>i(a.red(t),...e))(` ${l(t.duration)} `,t.fullName)))}if("warn"===r||"success"===r){n.filter((t=>"warn"===o(t.duration,e))).forEach((t=>((t,...e)=>i(a.yellow(t),...e))(` ${l(t.duration)} `,t.fullName)))}if("success"===r){n.filter((t=>"success"===o(t.duration,e))).forEach((t=>((t,...e)=>i(a.green(t),...e))(` ${l(t.duration)} `,t.fullName)))}},c=async s=>{const{testData:i,options:a,skipFileReport:o}=s,{warnAfterMs:n,errorAfterMs:l,logLevel:c,maxItems:f,jsonReportPath:m,csvReportPath:p}=a,d=(t=>{const{testResults:r}=t,s=t=>null!==t.duration,i=t=>"pending"!==t.status,a=r.map((t=>({testFilePath:t.testFilePath,testResults:t.testResults.filter(s).filter(i).map((t=>({duration:t.duration,fullName:t.fullName,status:t.status})))})));return e(a)})(i);var h,w;u(d,{errorAfterMs:l,warnAfterMs:n,logLevel:c,maxItems:f}),!o&&m&&(h=d,w=m,t.writeFileSync(w,JSON.stringify(h,null,2))),!o&&p&&await(async(t,e)=>r({path:e,header:[{id:"fullName",title:"NAME"},{id:"duration",title:"DURATION"},{id:"status",title:"STATUS"}]}).writeRecords(t))(d,p)};module.exports=class{constructor(t,e){this.jestOptions=t,this.reporterOptions=e}onRunComplete(t,e){c({testData:e,options:this.reporterOptions,skipFileReport:this.jestOptions.watch||this.jestOptions.watchAll})}onRunStart(){}getLastError(){}};
